--first attempt at using metatables

local myTable = {no = 'hi', lol = 12059, e = {}}
setmetatable(myTable, {
    __index = function(self, index, ...)
        if index == '__length' then
            local ctr = 0
            for i,v in pairs(self) do ctr = ctr + 1 end
            return ctr
        else
            if index == '__random' and self.__length > 0 then
                local x = math.random(1, self.__length)
                local ctr = 0 --iterate through table so dictionaries will also work
                for i,v in pairs(self) do ctr = ctr + 1 if ctr == x then return {Index = i,Value = v} end end
            else if index == '__tables' then
                local returntable = {}
                for i,v in pairs(self) do
                    if type(v) == 'table' then returntable[i] = v end
                end
                return returntable
                else if index == '__functions' then
                    local returntable = {}
                    for i,v in pairs(self) do
                        if type(v) == 'function' then returntable[i] = v end
                    end
                    return returntable
                end
            end
            end
        end
    end,
    __tostring = function(self)
        local sep = ''
        for i,v in pairs(self) do 
            self[i] = tostring(v)
            sep ..= ', '..self[i] 
        end
        return sep:sub(3,#sep)
    end,
    __call = function(self, ...)
        local returntable = {}
        for i,v in pairs(self) do
            for _,x in pairs({...}) do
                if not (type(v) == 'number' or type(v) == 'string') then continue end
                if tostring(v):find(tostring(x)) then returntable[i] = v break end
            end
        end
        return returntable
    end
})
for i,v in pairs(myTable.__functions) do print(i,v) end