if _G.on then _G.on:Disconnect() end
if _G.on2 then _G.on2:Disconnect() end
if _G.billboardorbandcoin then _G.billboardorbandcoin:Disconnect() end
if _G.mapmap then _G.mapmap:Disconnect() end

if game.CoreGui:FindFirstChild("OrbTracker") then game.CoreGui.OrbTracker:Destroy() end

local lp = game.Players.LocalPlayer
_G.on = game.RunService.Stepped:Connect(function()
    if not lp.Character then return end
    for i,v in pairs(lp.Character:GetChildren()) do if v:IsA"BasePart" then v.CanCollide = false end end
    pcall(function() lp.Character.HumanoidRootPart.CFrame = CFrame.new(0,-50,0) end)
    pcall(function() lp.Character.HumanoidRootPart.Velocity = Vector3.zero end)
    return
end)
local deadTick = tick()-10
local equiptick = tick() - 5
_G.on2 = game.RunService.Heartbeat:Connect(function()
    local con = lp.Character and lp.Character:FindFirstChild"HumanoidRootPart" and lp:FindFirstChild"Backpack" and (lp.Backpack:FindFirstChild"Darkheart" or lp.Character:FindFirstChild'Darkheart')
    if not lp.Character or (con and not lp.Character:FindFirstChild"Humanoid" or lp.Character.Humanoid.Health == 0) then
        deadTick = tick()
        equiptick = tick()
    end
    if not con or tick() - deadTick > 10 then
        if not con and tick() - equiptick > 5 then
            pcall(function() lp.Character.Humanoid.Health = 0 equiptick = tick() end)
        end
        return
    end
    if tick() - equiptick >= 5 then equiptick = tick() con.Parent = lp.Character end
    con:Activate()
end)
--orb track fork


local main = Instance.new("ScreenGui", game.CoreGui)
main.Name = "OrbTracker"
local defbb = Instance.new("BillboardGui")
defbb.Size = UDim2.new(0,25,0,25)
defbb.AlwaysOnTop = true
defbb.Active = true
local frame = Instance.new("TextButton", defbb)
frame.Name = "Button"
frame.Size = UDim2.new(1,0,1,0)
frame.Text = ""
function touch(what)
	firetouchinterest(game.Workspace[game.Players.LocalPlayer.Name].HumanoidRootPart, what, 0)
	firetouchinterest(game.Workspace[game.Players.LocalPlayer.Name].HumanoidRootPart, what, 1)
end
_G.billboardorbandcoin = game.Workspace.ChildAdded:Connect(function(v)
	if v.Name:find("__Orb") == 1 and v:IsA"BasePart" then
		local new = defbb:Clone()
		new.Parent = main
		new.Adornee = v
		new.Button.BackgroundColor3 = v.BrickColor.Color
		
        touch(v)
		new.Button.MouseButton1Down:Connect(function()
			touch(v)
		end)
	elseif v.Name:match("Ring__") then touch(v) end
end)
print('tracking orbs')

local http = game:GetService("HttpService")
function json(tbl) return http:JSONEncode(tbl) end

function makepost(server, args)
    return syn.request{
        Url = server,
        Method = "POST",
        Body = json(args),
        Headers ={['Content-Type'] = "application/json"}
    }
end

local serv = "https://(omit)"
local board = game.ReplicatedStorage.Board[lp.Name]
local blox = board.TotalEnemyCoins2
function comma_value(amount)
	local formatted = amount
	while true do
		formatted, k = string.gsub(formatted, "^(-?%d+)(%d%d%d)","%1,%2")
		if (k < 1) then
			break
		end
	end
	return formatted
end
makepost(serv, {
    content = "ready!\n"..comma_value(blox.Value*2)
})
local curBlox = blox.Value
_G.mapmap = blox.Changed:Connect(function()
    makepost(serv, {content = "Gained "..comma_value((blox.Value - curBlox) * 2).." exp!\nTotal: "..comma_value(blox.Value * 2)})
    curBlox = blox.Value
end)