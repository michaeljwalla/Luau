--a pretty  basic script to use items in bee swarm
--i didnt finish it, just wrote enough to get it partially working

local max = 10 --open animation speed (set to 1 to skip)
if game.CoreGui:FindFirstChild("AutoUser") then --i couldve just used a shared table connection
	game.CoreGui.AutoUser.UnloadAllThreads.Value = true
	wait(1)
end


local mainGui = Instance.new("ScreenGui", game.CoreGui)
mainGui.Name = "AutoUser"
local menu = Instance.new("Frame", mainGui)
menu.Name = "Menu"
menu.Size = UDim2.new(1,0,1,0)
menu.BackgroundTransparency = 1

local unloader = Instance.new("BoolValue", mainGui)
unloader.Name = "UnloadAllThreads"
unloader.Changed:Connect(function()
	if unloader.Value then
		wait(0.5) --let threads catch up
		unloader.Parent:Destroy()
	end
end)
function separateSpaces(str) --used to help format for remote calls i believe
	local templist = {}
	for i = 1, #str do
		table.insert(templist, str:sub(i,i))
	end
	local extractr = {}
	for i,v in pairs(templist) do
		if v == "-" then break end
		if i ~= 1 and string.upper(v) == v and v ~= " " then
			extractr[i] = i
		end
	end
	local ctr = 0
	for i,v in pairs(extractr) do
		table.insert(templist, (v+ctr), " ")
		ctr = ctr + 1
	end
	local final = ""
	for i,v in pairs(templist) do
		final = final..v
	end
	return final
end
function default(item, whatmenu) -- same as :Clone but running on no sleep
	if not whatmenu then whatmenu = menu end
	item.BackgroundColor3 = Color3.new(0.333333, 0.333333, 0.333333)
	item.Size = UDim2.new(0, 150, 0, 25)
	item.Font = Enum.Font.SourceSans
	item.TextColor3 = Color3.new(1, 1, 1)
	item.TextScaled = true
	item.TextSize = 14
	item.TextWrapped = true
	item.Position = UDim2.new(1, -150, 0.5, (#whatmenu:GetChildren()-2)*25)
	return item
end
function charAt(txt, index)
	return txt:sub(index,index)
end
function removeEndSpaces(text)
	if charAt(text, 1) == " " then
		 return removeEndSpaces(text:sub(2,#text))
	else if charAt(text, #text) == " " then
		return removeEndSpaces(text:sub(1, #text-1))
	end
	end
	return text
end
function resText(textbox, res)
	textbox.Focused:Connect(function()
		textbox.TextColor3 = Color3.new(1, 1, 1)
		textbox.Text = ""
	end)
	textbox.FocusLost:Connect(function()
		if string.gsub(textbox.Text, " ", "") == "" then
			textbox.TextColor3 = Color3.new(0.7, 0.7, 0.7)
			textbox.Text = res
		end
		textbox.Text = removeEndSpaces(textbox.Text)
	end)
end
local menuLabel = default(Instance.new("TextLabel", menu))
menuLabel.Position = UDim2.new(1, -150, 0.5, -25)
menuLabel.Text = "AutoUse"
menuLabel.Name = "Label"
local itemType = default(Instance.new("TextButton", menu))
itemType.Text = "Item"
itemType.TextColor3 = Color3.new(0.7, 0.7, 0.7)
itemType.Name = "ItemInput"
itemType.MouseButton1Down:Connect(function()
	toggleItemList() --before i used local to def functions
end)

local usables = {}
--couldve just made the table myself
for i,v in pairs(require(game:GetService("ReplicatedStorage").EggTypes).GetTypes()) do
	if v.Usable and not v.Name:find("Nectar") and not v.Name:find("Balloon") and not v.Name:find("Planter")and not v.Name:find("Night")and not v.Name:find("Honeysuckle") and not v.Name:find("Skill")and not v.Name:find("Sprinkler")and not v.Name:find("FestiveBean") then table.insert(usables, v) end
end
function getCurrentActive()
	for i,v in pairs(usables) do
		if v.Name == itemType.Text then return v end
	end
end
--will be useful later 
--print(usables[2].PlayerActive:IsOnCooldown()) --later: I never finished

local itemPopup = Instance.new("ScrollingFrame", itemType)
itemPopup.Position = itemType.Position - UDim2.new(0,215,0,60)
itemPopup.BackgroundColor3 = Color3.new(1/3,1/3,1/3)
itemPopup.Visible = false
itemPopup.ClipsDescendants = true
itemPopup.Size = UDim2.new(0, 210, 0, 120)
itemPopup.ScrollBarThickness = 1
local roundit = (#usables/7) % 1
if roundit ~= 0 then
itemPopup.CanvasSize = UDim2.new(0,200,0,30*((#usables/7)+roundit))
end

if not max or max < 1 or type(max) ~= "number" then --doing too much
	max = 15
end
max = math.floor(max)

function toggleItemList() --from the usables list
	if not itemPopup.Visible then
		itemPopup.Size = UDim2.new(0,0,0,120)
		itemPopup.Visible = true
		for i = 1, max do --couldve tweened here
			task.wait()
			itemPopup.Size = UDim2.new(0,(i/max)*210,0,120)
		end
	else do
		itemPopup.Size = UDim2.new(0,210,0,120)
		for i = 1, max do -- idem hic
			task.wait()
			itemPopup.Size = itemPopup.Size - UDim2.new(0,210*(1/max),0,0)
		end
		itemPopup.Visible = false
	end
	end
end

local lineOn = -1
function makeItemIcon(itemTable, iteration) --to turn the items from usables list into a gui object
	local new = Instance.new("ImageButton", itemPopup)
	new.Name = itemTable.Name
	new.Size = UDim2.new(0,30,0,30)
	if (iteration-1) % 7 == 0 then
		lineOn = lineOn + 1
	end
	new.Position = UDim2.new(0,30*((#itemPopup:GetChildren()-1) % 7), 0, 30*lineOn) --make NOT add 30 to pos until multiple of 7 (the 7s should stay (30*7 = width)) --old comment
	new.BorderSizePixel = 0
	new.BackgroundColor3 = Color3.new(1/3,1/3,1/3)
	new.Image = itemTable.Icon
	new.MouseButton1Down:Connect(function()
		itemType.Text = itemTable.Name
		toggleItemList()
	end)
end

--ugh manual sort is prettier but this table changes too much to work well :(
for i,v in pairs(usables) do
	makeItemIcon(v,i)
end

local startBtnDisabled = default(Instance.new("TextLabel", menu))
startBtnDisabled.Text = "Start"
startBtnDisabled.BackgroundTransparency = 0.4
startBtnDisabled.TextColor3 = Color3.new(0.5, 0.5, 0.5)
startBtnDisabled.Name = "StartButtonDisabled"

local startBtnEnabled = default(Instance.new("TextButton", menu))
startBtnEnabled.Position = startBtnEnabled.Position + UDim2.new(0,160,0,-25)
startBtnEnabled.Text = "Start"
startBtnEnabled.Name = "StartButton"
--if textbox changed and text found in usables then open start button
itemType.Changed:Connect(function()
	for i,v in pairs(usables) do
		if itemType.Text == v.Name then
			startBtnEnabled.Position = startBtnDisabled.Position
			break
		end
	end
end)


local tsetup = Instance.new("Frame", mainGui)
tsetup.Size = UDim2.new(0,300,0,500)
tsetup.BackgroundColor3 = Color3.new(1/3,1/3,1/3)
tsetup.Name = "Setup Menu"
tsetup.Position = UDim2.new(1,0,1,0)
function togglesetup(bool) if bool then tsetup.Position = UDim2.new(1,-700,0.5,-250) else do tsetup.Position = UDim2.new(1,0,1,0) end end end   

--togglesetup(true) --debug

local closeSetup = Instance.new("TextButton", tsetup)
closeSetup.Size = UDim2.new(0,30,0,30)
closeSetup.Text = "X"
closeSetup.TextScaled = true
closeSetup.Position = UDim2.new(1,-30,0,0)
closeSetup.MouseButton1Down:Connect(function() togglesetup(false) end)
closeSetup.Name = "CloseBtn"
local dragbar = Instance.new("Frame", tsetup)
dragbar.Size = UDim2.new(1,-30,0,30)
dragbar.BackgroundColor3 = Color3.new(1/3,1/3,1/3)

local movewithme
--thx devforum
function mousePos()
	local mouse = game.Players.LocalPlayer:GetMouse()
	return {x = mouse.X, y = mouse.Y}
end
local mouse = game.Players.LocalPlayer:GetMouse()
local start, curPos
dragbar.InputBegan:Connect(function(InputObject)
        if InputObject.UserInputType == Enum.UserInputType.MouseButton1 then
            movewithme = mouse.Button1Down:Connect(function()
	            start = mousePos()
	            while task.wait() and movewithme.Connected do
	            	curPos = mousePos()
	            	if curPos.x ~= start.x or curPos.y ~= start.y then
	            		tsetup.Position = tsetup.Position + UDim2.new(0,curPos.x - start.x,0, curPos.y - start.y)
	            		start = mousePos()
	            	end
	            end
	        end)
        end
    end
)
local mouseConnection
mouseConnection = mouse.Button1Up:Connect(function()
	if dragbar == nil then mouseConnection:Disconnect() else do
		start = mousePos()
		curPos = start
		pcall(function()movewithme:Disconnect()end)
	end end
end)

--make sure to follow pattern
local setupvars = {
	itemName = "Snowflake (default)",
	imgThumbnail = usables[1].Icon
}
local slabels = Instance.new("Folder", tsetup)
slabels.Name = "Labels and stuff"

local sitemicon = Instance.new("ImageLabel", slabels)
sitemicon.Name = "imgThumbnail"
sitemicon.Size = UDim2.new(0,100,0,100)
sitemicon.Position = UDim2.new(0,100,0,40)
sitemicon.Image = setupvars.imgThumbnail
sitemicon.BackgroundTransparency = 1
local namelabel = default(Instance.new("TextLabel", slabels))
namelabel.Name = "itemName"
namelabel.Position = UDim2.new(0,20,0,150)
namelabel.BackgroundTransparency = 1
namelabel.Text = setupvars.itemName--setupvars.itemName
namelabel.TextXAlignment = "Center"
namelabel.FontSize = 12
namelabel.Size = UDim2.new(1,-40,0,35)

function refreshText(str) --item.Text = key in setupvars that shares item name
	setupvars.itemName = str
	for i,v in pairs(usables) do
		if v.Name == str then
			setupvars.imgThumbnail = v.Icon
			break
		end
	end
	namelabel.Text = setupvars.itemName
	sitemicon.Image = setupvars.imgThumbnail
end

shared.gsglobals = { --supposed to be a placeholder but I think i messed up the format
	name = "No Name",
	delay = 999,
	amount = 1,
	time = 999
}

local globalsettings = Instance.new("Frame", tsetup)
globalsettings.Name = "always available"
globalsettings.Size = UDim2.new(0,260,0,75)
globalsettings.Position = UDim2.new(0.5,-130,0.5,-45)
globalsettings.BackgroundColor3 = tsetup.BackgroundColor3
local gslabel = default(Instance.new("TextLabel", slabels), slabels)
gslabel.Name = "defaultsLabel"
gslabel.Text = "Defaults:"
gslabel.Size = UDim2.new(0,150,0,15)
gslabel.TextXAlignment = "Left"
gslabel.Position = globalsettings.Position + UDim2.new(0,0,0,-15)
gslabel.BackgroundTransparency = 1
local gsAmtLabel = default(Instance.new("TextLabel", globalsettings), globalsettings)
gsAmtLabel.Name = "AmountLabel"
gsAmtLabel.Text = "Amount: "
gsAmtLabel.Size = UDim2.new(0,130,0,25)
gsAmtLabel.Position = UDim2.new(0,0,0,0)
local gsAmtInput = default(Instance.new("TextBox", globalsettings), globalsettings)
gsAmtInput.Name = "AmountInput"
gsAmtInput.Text = shared.gsglobals.amount
gsAmtInput.Size = UDim2.new(0,130,0,25)
gsAmtInput.Position = UDim2.new(0,130,0,0)
local gsDelayLabel = default(Instance.new("TextLabel", globalsettings), globalsettings)
gsDelayLabel.Name = "DelayLabel"
gsDelayLabel.Text = "Delay (s): "
gsDelayLabel.Size = UDim2.new(0,130,0,25)
gsDelayLabel.Position = UDim2.new(0,0,0,25)
local gsDelayInput = default(Instance.new("TextBox", globalsettings), globalsettings)
gsDelayInput.Name = "DelayInput"
gsDelayInput.Text = shared.gsglobals.delay
gsDelayInput.Size = UDim2.new(0,130,0,25)
gsDelayInput.Position = UDim2.new(0,130,0,25)
local gsTimeLabel = default(Instance.new("TextLabel", globalsettings), globalsettings)
gsTimeLabel.Name = "runtimeLabel"
gsTimeLabel.Text = "Runtime (s):"
gsTimeLabel.Size = UDim2.new(0,130,0,25)
gsTimeLabel.Position = UDim2.new(0,0,0,50)
local gsTimeInput = default(Instance.new("TextLabel", globalsettings), globalsettings)
gsTimeInput.Name = "runtimeInput"
gsTimeInput.Text = shared.gsglobals.time
gsTimeInput.Size = UDim2.new(0,130,0,25)
gsTimeInput.Position = UDim2.new(0,130,0,50)
gsTimeInput.TextColor3 = Color3.new(0.5, 0.5, 0.5)

--i dont feel like remembering what everything did
gsAmtInput.FocusLost:Connect(function()
	resetConfirm() -- throws up
	local txt = gsAmtInput.Text
	if not tonumber(txt) then gsAmtInput.Text = shared.gsglobals.amount end
	gsAmtInput.Text = math.floor(gsAmtInput.Text)
	if tonumber(gsAmtInput.Text) < 1 then gsAmtInput.Text = shared.gsglobals.amount end
	if tonumber(gsTimeInput.Text) ~= gsAmtInput.Text*gsDelayInput.Text then gsTimeInput.Text = gsAmtInput.Text*gsDelayInput.Text end 
	shared.gsglobals.amount = tonumber(gsAmtInput.Text)
	shared.gsglobals.delay = tonumber(gsDelayInput.Text)
	shared.gsglobals.time = shared.gsglobals.amount * shared.gsglobals.delay --pls why is there so much shit
end)
gsDelayInput.FocusLost:Connect(function()
	resetConfirm()
	local txt = gsDelayInput.Text
	if not tonumber(txt) then gsDelayInput.Text = shared.gsglobals.delay end
	gsDelayInput.Text = math.floor(gsDelayInput.Text)
	if tonumber(gsDelayInput.Text) < shared.gsglobals.ogdelay then gsDelayInput.Text = shared.gsglobals.delay end
	if tonumber(gsTimeInput.Text) ~= gsAmtInput.Text*gsDelayInput.Text then gsTimeInput.Text = gsAmtInput.Text*gsDelayInput.Text end 
	shared.gsglobals.amount = tonumber(gsAmtInput.Text)
	shared.gsglobals.delay = tonumber(gsDelayInput.Text)
	shared.gsglobals.time = shared.gsglobals.amount * shared.gsglobals.delay
end)
--[[gsTimeInput.FocusLost:Connect(function()
	resetConfirm()
	local txt = gsTimeInput.Text
	print(tonumber(txt)/tonumber(gsDelayInput.Text))
	if tonumber(txt) and tonumber(txt)/tonumber(gsDelayInput.Text) > tonumber(gsAmtInput.Text) then gsAmtInput.Text = math.floor(shared.gsglobals.time/shared.gsglobals.delay) return end
	if not tonumber(txt) then gsTimeInput.Text = shared.gsglobals.time end
	if math.floor(shared.gsglobals.time/shared.gsglobals.delay) < shared.gsglobals.amount then shared.gsglobals.amount = math.floor(shared.gsglobals.time/shared.gsglobals.delay) gsAmtInput = gsglobals.amount end
	gsTimeInput.Text = math.floor(gsTimeInput.Text)
	shared.gsglobals.amount = tonumber(gsAmtInput.Text)
	shared.gsglobals.delay= tonumber(gsDelayInput.Text)
	shared.gsglobals.time = shared.gsglobals.amount * shared.gsglobals.delay
end)]]--

function loadglobalvalues(tbl)
	shared.gsglobals.name = tbl.Name
	shared.gsglobals.amount = 1 --reset
	shared.gsglobals.delay = tbl.UseCooldown
	shared.gsglobals.ogdelay = tbl.UseCooldown
	shared.gsglobals.time = shared.gsglobals.amount * shared.gsglobals.delay
	gsDelayInput.Text = shared.gsglobals.delay
	gsTimeInput.Text = shared.gsglobals.time
	gsAmtInput.Text = shared.gsglobals.amount
end

local startThreadButton = default(Instance.new("TextButton", tsetup), tsetup)
startThreadButton.Size = UDim2.new(1,0,0,25)
startThreadButton.Position = UDim2.new(0,0,1,-25)
startThreadButton.Name = "Start Thread Button"
startThreadButton.Text = "Start"


shared.loops = {}


local confPressTick = tick()
local pressamt = 0
function resetConfirm()
	confPressTick = tick()
	pressamt = 0
	startThreadButton.Text = "Start"
end
startBtnEnabled.MouseButton1Down:Connect(function()
	for i,v in pairs(usables) do
		if v.Name == itemType.Text then loadglobalvalues(v) break end
	end
	togglesetup(true)
	refreshText(itemType.Text)
	resetConfirm()
end) 

startThreadButton.MouseButton1Down:Connect(function()
	pressamt = pressamt + 1
	if pressamt == 1 then -- makes you click twice
		startThreadButton.Text = "Confirm?" confPressTick = tick()
		while wait() do
			if pressamt == 2 or pressamt == 0 then startThreadButton.Text = "Start" pressamt = 0 break end
			if tick() - confPressTick > 5 then startThreadButton.Text = "Start" pressamt = 0 break end
		end
		return
	end
	if pressamt == 2 and tick() - confPressTick < 5 then 
		 --idk bro it wont work --old comment, idk what happened and i dont reeally care anymore
		print(shared.gsglobals.amount, shared.gsglobals.delay, shared.gsglobals.time)
		if shared.loops[shared.gsglobals.name] then shared.loops[shared.gsglobals.name].Running = false end
		spawn(function()
			makeThread(shared.gsglobals.name, shared.gsglobals.delay, shared.gsglobals.time) 
		end)
		pressamt = 0
		startThreadButton.Text = "Start"
		togglesetup(false) 
	end
end)

--remove space later --old comment

local threadmanager = Instance.new("Frame", mainGui)
threadmanager.Name = "Threads"
threadmanager.Size = UDim2.new(1,0,1,0)
threadmanager.BackgroundTransparency = 1
local openthreads = default(Instance.new("TextButton", threadmanager), threadmanager)
openthreads.Size = UDim2.new(0,25,0,25)
openthreads.Text = "<<"
openthreads.Position += UDim2.new(0,125,0,#menu:GetChildren()*25)
local threadframe = Instance.new("Frame", threadmanager)
threadframe.Position = openthreads.Position + UDim2.new(0,25,0,0)
threadframe.BackgroundColor3 = openthreads.BackgroundColor3
threadframe.Size = UDim2.new(0,200,0,200)
threadframe.ClipsDescendants = true

local threadscroller = Instance.new("ScrollingFrame", threadframe)
threadscroller.Size = UDim2.new(1,0,1,0)
threadscroller.BackgroundColor3 = openthreads.BackgroundColor3
threadscroller.CanvasSize = threadscroller.Size
threadscroller.ChildAdded:Connect(function()
	threadscroller.CanvasSize = UDim2.new(0,150,0,25*#threadscroller:GetChildren()) 
end)
threadscroller.ChildRemoved:Connect(function()
	threadscroller.CanvasSize = UDim2.new(0,150,0,25*#threadscroller:GetChildren()) 
end)
threadsopened = false
openthreads.MouseButton1Down:Connect(function()
	if not threadsopened then
		openthreads.Text = ">>"
		threadsopened = true
		openthreads.Position = openthreads.Position + UDim2.new(0,-200,0,0)
		threadframe.Position = openthreads.Position + UDim2.new(0,25,0,0)
	else do --do end lol
		openthreads.Text = "<<"
		threadsopened = false
		openthreads.Position = openthreads.Position + UDim2.new(0,200,0,0)
		threadframe.Position = openthreads.Position + UDim2.new(0,25,0,0)
	end
	end
end)




-- #usables = 28 (27 after beesmas) --old comment
function useItem(item, delay, time, textbox)
	local frame = textbox
	local textbox = frame.progress --didnt wnat to go thru entire thing again --old comment
	
	local args = {[1] = {["Name"] = ""}}
	local count = 0
	shared.loops[item] = {}
	local path = shared.loops[item]
	path.Running = true
	path.Paused = false
	
	local ticker = tick()
	local delayer = tick() - delay
	local max = math.floor(time/delay)
	args[1]["Name"] = separateSpaces(item)
	textbox.Text = item.." "..count.."/"..max.." @ "..delay.."s"
	local onpress
	onpress = textbox.MouseButton1Down:Connect(function()
		if path.Paused then
			path.Paused = false
			textbox.TextColor3 = Color3.new(1,1,1)
		else do
			path.Paused = true
			textbox.TextColor3 = Color3.new(1,1,0)
		end
		end
	end)
	

	while wait() and (tick() - ticker) <= time and path.Running do
		if count/max == 1 then break end
		if not path.Paused and (tick() - delayer) >= delay then
			count = count +  1
			delayer = tick()
			game:GetService("ReplicatedStorage").Events.PlayerActivesCommand:FireServer(unpack(args))
			textbox.Text = item.." "..count.."/"..max.." @ "..delay.."s"
		else if path.Paused then
			ticker = (tick() - ticker)+tick() --bs --old comment
			delayer = delayer + (tick() - delayer)--huh??? why does it work --old comment
		end
		end
		if not path.Paused then
			frame.bg.Size = UDim2.new(((tick() - delayer)/delay*1),0,1,0)
		end
	end
	onpress:Disconnect()
	textbox.TextColor3 = Color3.new(0,1,0)
	textbox.MouseButton1Down:Connect(function()
		path.Running = false 
		frame:Destroy() 
		for i,v in pairs(threadscroller:GetChildren()) do
			v.Position = UDim2.new(0,0,0,25*(i-1))
		end 
	end)
	
	
	
	return true, print(item.." loop ended")
end

function makeThread(item, delay, amount) --called makeThread but doesnt even make a new thread
	local newThread = Instance.new("Frame", threadscroller)
	newThread.Name = item
	newThread.Position = UDim2.new(0,0,0,25*(#threadscroller:GetChildren()-1))
	newThread.Size = UDim2.new(1,0,0,25)
	newThread.BackgroundColor3 = Color3.new(1/3,1/3,1/3)
	local bg = Instance.new("Frame", newThread)
	bg.Name = "bg"
	bg.Size = UDim2.new(0,0,0,0)
	bg.BorderSizePixel = 0
	bg.BackgroundColor3 = Color3.new(0.2,0.2,0.2)
	local txtbox = default(Instance.new("TextButton", newThread), newThread)
	txtbox.Name = "progress"
	txtbox.Size = UDim2.new(1,0,1,0)
	txtbox.Position = UDim2.new(0,0,0,0)
	txtbox.BackgroundTransparency = 1
	if shared.loops[item] then shared.loops[item].StoppedEarly = true shared.loops[item].Running = false end
	useItem(item, delay, amount, newThread)
end

--below are examples of what the buttons do
--deprecated spawnðŸ˜¬
--spawn(function()makeThread("Snowflake", 3, 6)end)
--spawn(function()makeThread("Gumdrops", 3, 50)end)