--add a debounce to the main script, spam running can force-open connections
local function require(d, recache)
    shared.requirecache = shared.requirecache or {}
    if (typeof(d) ~= 'string') then return getfenv().require(d) end
    if d:find"^http" then return loadstring(game:HttpGet(d))()
    else
        if not recache and shared.requirecache[d] then return shared.requirecache[d] end
        local n, a = pcall(readfile, d..".lua") --loadfile lol
        assert(n, "No local module '"..d.."'")
        local chunk = loadstring(a)
        assert(chunk, "Error in local: "..d)
        shared.requirecache[d] = chunk()
        return shared.requirecache[d]
    end
end
local function hasprop(inst, prop, pcd)
    return pcd and inst[prop] or pcall(hasprop, inst, prop, true)
end
local function apply(inst, props)
    local parent = props.Parent
    props.Parent = nil
    for i,v in next, props do
        if hasprop(inst, i) then
            inst[i] = v
        end
    end
    if parent then inst.Parent = parent end
    return inst
end
local walker = require"bell/conjoiner"
    --walker:ToField"Dandelion Field"
local gui = require("bell/inprog/gui", true)

local lp = game.Players.LocalPlayer
local rs = game:GetService"ReplicatedStorage"

gui:AddMenu("Home / Farmer")--, Color3.fromRGB(15, 217, 106))
for i = 1, 15 do
    gui:AddMenu(i, Color3.new(1,1,1))
end


local menu1 = gui:SwitchTo("Home / Farmer")
gui:Enable()
local fieldicon = (function()
    local newt = {}
    for i,v in next, rs.SmallFieldIcons:GetChildren() do
        newt[v.Name] = v.Texture
    end
    return newt
end)()
local itemicon = (function()
    local newt = {}
    for i,v in next, rs.EggTypes:GetChildren() do
        if not v:IsA"Decal" then continue end
        newt[v.Name:sub(1,-5)] = v.Texture
    end
    return newt
end)()
local flowericon = {
    White = {
        'rbxassetid://4845910633',
        'rbxassetid://4845911261',
        'rbxassetid://4845911635',
        'rbxassetid://4845912024',
        '',
    },
    Red = {
        'rbxassetid://4845903216',
        'rbxassetid://4845903593',
        'rbxassetid://4845904033',
        '',
        '',
    },
    Blue = {
        'rbxassetid://4845898642',
        'rbxassetid://4845899125',
        'rbxassetid://4845899467',
        '',
        '',
    },
}
do
    local m1frame = menu1.Frame
    local leftside = gui:Name("Left", gui:AddBasic("Frame", UDim2.new(0.425,0,0.9,0), UDim2.new(0.05,0,0.05,0), m1frame))
    local rightside = gui:Name("Right", gui:AddBasic("Frame", UDim2.new(0.425,0,0.9,0), UDim2.new(0.525,0,0.05,0), m1frame))
    
    --field dropdown
    local fieldchoice = gui:AddBasic("TextButton", UDim2.new(0.9,0,0,25), UDim2.new(0.05,0,0,10), m1frame.Left)
    gui:ApplyProps(fieldchoice, {
        BackgroundColor3 = gui:GetThemeColor"Dark",
        Text = "Dandelion Field"
    })
    gui:Name("Fields", fieldchoice)
    gui:AddImgToText(fieldchoice, fieldicon["Dandelion Field"], true)
    gui:DropdownButton(
        fieldchoice,
        UDim2.new(1,0,0,150),
        workspace.FlowerZones:GetChildren(),
        "Name",
        {
            OnChange = function(curval)
                fieldchoice.RealText.Text = curval
                fieldchoice.Icon.Image = fieldicon[curval]
            end
        }
    )
    for i,v in next, fieldchoice.Dropdown:GetChildren() do
        if not v.ClassName:find("Text") then continue end
        gui:AddImgToText(v, fieldicon[tostring(v)], true)--changes normal text obj into text obj with image frame
    end
    -- button toggle test
    local farmtoggle = gui:ApplyProps(gui:AddBasic("TextLabel", UDim2.new(0.9,0,0,20), UDim2.new(0.05,0,0,40), leftside), {
        BackgroundColor3 = gui:GetThemeColor"Medium",
        Text = "    Farming",
        TextSize = 12,
        TextXAlignment = "Left",
        Name = "Autofarm"
    })
    gui:AddUiToggle(farmtoggle, nil, true) --changes normal text obj into text obj with color frame
    --radio button test
    local farmingtypechoice = gui:AddRadioButtons(
        {Parent = farmtoggle, Size = UDim2.new(0.75,0,0,0), Position = UDim2.new(0,0,1,1)}, --container data size and pos
        {Size = UDim2.new(1,0,0,15), TextSize = 10, RightSide = true, Default = 1, Background = gui:GetThemeColor"Medium", StartsFrom = "Center"}, --radio button data
        {"Workspace", "ServerEvent"} --options
        )--is able to add extra funcs to thing so
    --dragbar test
    local bagfillpercent = gui:AddDragbar(
        {Text = "Fill %", OverlayColor = Color3.new(1,1,1), Parent = leftside, Size = UDim2.new(0.9,0,0,20), Position = UDim2.new(0.05,0,0,95), Border = 2},
        {Type = "TextBox", Size = UDim2.fromOffset(20,20), TextSize = 10, RightSide = true},
        {Min = 1, Max = 100, Step = 5, Default = 100},
        {OnChange = nil}
    )
    --right side menu
    local fieldanalysis = gui:ApplyProps(gui:AddBasic("Frame", UDim2.new(0.9,0,0,55), UDim2.new(0.05,0,0,10), rightside), {
        BackgroundColor3 = gui:GetThemeColor"Medium",
        Name = "FieldAnalysis"
    })
    local fadescriptor = gui:ApplyProps(gui:AddBasic("TextLabel", UDim2.new(1,0,0,15), nil, fieldanalysis), {
        Text = "Field Analysis",
        Name = "Descriptor",
        TextSize = 12,
        BackgroundColor3 = gui:GetThemeColor"Dark"
    })
    local fa_pollenfillbar = gui:ApplyProps(gui:AddFillbar(
        {Text = "Field Quality", OverlayColor = Color3.new(1,1,1), Parent = fieldanalysis, Size = UDim2.new(1,0,0,20), Position = UDim2.fromOffset(0,15), Border = 2},
        {Type = "ImageLabel",Size = UDim2.fromOffset(20,20), TextSize = 10, RightSide = true},
        {
            Color3.fromRGB(219, 42, 42),
            Color3.fromRGB(240, 221, 10),
            Color3.fromRGB(48, 219, 42)
        }
    ), {
        --Name = "Pollen Quality"
    })
    fa_pollenfillbar.Indicator.Image = flowericon.White[4]
    local fa_goofillbar = gui:ApplyProps(gui:AddFillbar(
        {Text = "Goo Coverage", OverlayColor = Color3.new(1,1,1), Parent = fieldanalysis, Size = UDim2.new(1,0,0,20), Position = UDim2.fromOffset(0,35), Border = 2},
        {Type = "ImageLabel",Size = UDim2.fromOffset(20,20), TextSize = 10, RightSide = true, Default = 0},
        {
            Color3.fromRGB(219, 42, 42),
            Color3.fromRGB(240, 221, 10),
            Color3.fromRGB(48, 219, 42)
        }
    ), {
        --Name = "Goo Coverage"
    })
    fa_goofillbar.Indicator.Image = itemicon.Gumdrops
end